!function(){function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var e=new(function(){var e;function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];if(!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),4===t.length&&t.every(function(t){return 4===t.length}))this.initialState=t,this.restart();else throw Error("Initial state is not valid!")}return e=[{key:"moveLeft",value:function(){if("playing"===this.status){var t=this.moveTiles(!0,!1);this.isStateDifferent(t.state)&&this.updateGame(t)}}},{key:"moveRight",value:function(){if("playing"===this.status){var t=this.moveTiles(!0,!0);this.isStateDifferent(t.state)&&this.updateGame(t)}}},{key:"moveUp",value:function(){if("playing"===this.status){var t=this.moveTiles(!1,!1);this.isStateDifferent(t.state)&&this.updateGame(t)}}},{key:"moveDown",value:function(){if("playing"===this.status){var t=this.moveTiles(!1,!0);this.isStateDifferent(t.state)&&this.updateGame(t)}}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.restart(),this.status="playing",this.putNewNumber(),this.putNewNumber()}},{key:"restart",value:function(){this.state=this.cloneState(this.initialState),this.score=0,this.status="idle",this.firstMoveMade=!1}},{key:"cloneState",value:function(e){for(var r,n=[],i=0;i<e.length;i++)n.push(function(e){if(Array.isArray(e))return t(e)}(r=e[i])||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(e,r){if(e){if("string"==typeof e)return t(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,void 0)}}(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return n}},{key:"isStateDifferent",value:function(t){for(var e=0;e<this.state.length;e++)for(var r=0;r<this.state[e].length;r++)if(this.state[e][r]!==t[e][r])return!0;return!1}},{key:"updateGame",value:function(t){this.state=t.state,this.score+=t.score,this.firstMoveMade=!0,this.putNewNumber(),this.isGameLost()?this.status="lose":this.isGameWon()&&(this.status="win")}},{key:"getFirstMoveMade",value:function(){return this.firstMoveMade}},{key:"getAvailableSpace",value:function(){return this.state.reduce(function(t,e,r){return e.forEach(function(e,n){0===e&&t.push({x:n,y:r})}),t},[])}},{key:"getRandomSpace",value:function(t){return t[Math.floor(Math.random()*t.length)]}},{key:"getNewNumber",value:function(){return 0===Math.floor(10*Math.random())?4:2}},{key:"putNewNumber",value:function(){var t=this.getAvailableSpace(),e=this.getRandomSpace(t);this.state[e.y][e.x]=this.getNewNumber()}},{key:"isGameLost",value:function(){return 0===this.getAvailableSpace().length&&!(this.isStateDifferent(this.moveTiles(!1,!1).state)||this.isStateDifferent(this.moveTiles(!0,!0).state)||this.isStateDifferent(this.moveTiles(!1,!0).state)||this.isStateDifferent(this.moveTiles(!0,!1).state))}},{key:"isGameWon",value:function(){return this.state.some(function(t){return t.some(function(t){return 2048===t})})}},{key:"getCellCoords",value:function(t,e,r){return t?{row:e,column:r}:{row:r,column:e}}},{key:"moveTiles",value:function(t,e,r){var n,i,a,s,o,u,l=this.cloneState(this.state),c=0,f=l[0].length,h=l.length;t?(n=h,i=f):(n=f,i=h),e?(a=i-2,s=-1,o=i,u=1):(a=1,s=i,o=-1,u=-1);for(var v=0;v<n;v++)for(var m=Array(i).fill(!1),d=a;d!==s;d-=u){for(var y=!1,g=d,p=this.getCellCoords(t,v,g),S=this.getCellCoords(t,v,g+u);g+u!==o&&(0===l[S.row][S.column]||l[S.row][S.column]===l[p.row][p.column]&&!m[g+u]&&!y);)l[S.row][S.column]>0&&(y=!0,c+=2*l[S.row][S.column]),l[S.row][S.column]+=l[p.row][p.column],l[p.row][p.column]=0,g+=u,p=this.getCellCoords(t,v,g),S=this.getCellCoords(t,v,g+u);y&&(m[g]=!0)}return{state:l,score:c}}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(r.prototype,e),r}());function r(){var t;!function(t){for(var e=document.querySelectorAll(".field-row"),r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++){var i=e[r].children[n],a=t[r][n];i.className="field-cell field-cell--"+a,a>0?i.innerText=a:i.innerText=""}}(e.getState()),t=e.getScore(),document.querySelector(".game-score").innerText=t,e.getFirstMoveMade()?(n.className="button restart",n.innerText="Restart"):(n.className="button start",n.innerText="Start"),function(t){switch(document.querySelectorAll(".message").forEach(function(t){return t.classList.add("hidden")}),t){case"idle":document.querySelector(".message-start").classList.remove("hidden");break;case"win":document.querySelector(".message-win").classList.remove("hidden");break;case"lose":document.querySelector(".message-lose").classList.remove("hidden")}}(e.getStatus())}var n=document.querySelector(".button");n.addEventListener("click",function(){switch(n.innerText){case"Start":e.start();break;case"Restart":e.restart()}r()}),document.addEventListener("keydown",function(t){switch(t.key){case"ArrowUp":t.preventDefault(),e.moveUp();break;case"ArrowRight":t.preventDefault(),e.moveRight();break;case"ArrowDown":t.preventDefault(),e.moveDown();break;case"ArrowLeft":t.preventDefault(),e.moveLeft()}r()})}();
//# sourceMappingURL=index.c32ae313.js.map
